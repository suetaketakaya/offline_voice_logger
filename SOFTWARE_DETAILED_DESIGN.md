# OfflineVoiceLogger - ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢è©³ç´°è¨­è¨ˆæ›¸

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0
**ä½œæˆæ—¥**: 2025-11-09
**å¯¾è±¡**: Windows 10/11 64bit

---

## ç›®æ¬¡

1. [ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦](#1-ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦)
2. [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ](#2-ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ)
3. [ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­è¨ˆ](#3-ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­è¨ˆ)
4. [ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆ](#4-ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆ)
5. [ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ](#5-ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ)
6. [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ](#6-ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ)
7. [ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨­è¨ˆ](#7-ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨­è¨ˆ)
8. [ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°è¨­è¨ˆ](#8-ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°è¨­è¨ˆ)
9. [ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆè¨­è¨ˆ](#9-ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆè¨­è¨ˆ)

---

## 1. ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

### 1.1 ç›®çš„
Windowsãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ä¸Šã®éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ã‚­ãƒ£ãƒ—ãƒãƒ£ã—ã€faster-whisperã‚’ä½¿ç”¨ã—ã¦æ—¥æœ¬èª/è‹±èªã®æ–‡å­—èµ·ã“ã—ã‚’è¡Œã†å®Œå…¨ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å‹•ä½œã®ãƒ„ãƒ¼ãƒ«ã€‚ç¤¾å¤–ç§˜æƒ…å ±ã‚’æ‰±ã†ãŸã‚ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ä¸€åˆ‡è¡Œã‚ãªã„ã€‚

### 1.2 ä¸»è¦æ©Ÿèƒ½
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ éŸ³å£°ã‚­ãƒ£ãƒ—ãƒãƒ£ï¼ˆWASAPIçµŒç”±ï¼‰
- faster-whisper (large-v3/medium) ã«ã‚ˆã‚‹æ–‡å­—èµ·ã“ã—
- æ—¥æœ¬èª/è‹±èªã®è¨€èªé¸æŠ
- è¤‡æ•°å½¢å¼ã§ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆTXT/SRT/JSONï¼‰
- å®Œå…¨ãƒ­ãƒ¼ã‚«ãƒ«å‹•ä½œï¼ˆã‚ªãƒ•ãƒ©ã‚¤ãƒ³ï¼‰
- MSIã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã§ã®é…å¸ƒ

### 1.3 ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶

#### æœ€å°è¦ä»¶
- CPU: Intel Core i5 ç¬¬8ä¸–ä»£ä»¥ä¸Š / AMD Ryzen 5 3000ã‚·ãƒªãƒ¼ã‚ºä»¥ä¸Š
- ãƒ¡ãƒ¢ãƒª: 8GB RAM
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: 5GB ç©ºãå®¹é‡
- OS: Windows 10 64bitä»¥é™

#### æ¨å¥¨è¦ä»¶
- CPU: Intel Core i7 ç¬¬10ä¸–ä»£ä»¥ä¸Š / AMD Ryzen 7 3000ã‚·ãƒªãƒ¼ã‚ºä»¥ä¸Š
- ãƒ¡ãƒ¢ãƒª: 16GB RAMä»¥ä¸Š
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: SSD 10GBä»¥ä¸Š
- OS: Windows 10/11 64bit

---

## 2. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

### 2.1 ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤              â”‚
â”‚  (GUI: tkinter/PyQt5)                                   â”‚
â”‚  - ãƒ¡ã‚¤ãƒ³ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦                                       â”‚
â”‚  - è¨­å®šãƒ€ã‚¤ã‚¢ãƒ­ã‚°                                         â”‚
â”‚  - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤                      â”‚
â”‚  - ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©                                       â”‚
â”‚  - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯                                       â”‚
â”‚  - è¨­å®šç®¡ç†                                               â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚          â”‚          â”‚          â”‚
â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â” â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â” â”Œâ”€â”€â”´â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ éŸ³å£°   â”‚ â”‚ æ–‡å­—   â”‚ â”‚ ãƒ•ã‚¡ã‚¤ãƒ«â”‚ â”‚ ãƒªã‚½ãƒ¼ã‚¹    â”‚
â”‚ã‚­ãƒ£ãƒ—ãƒãƒ£â”‚ â”‚èµ·ã“ã—  â”‚ â”‚ ç®¡ç†   â”‚ â”‚ ç›£è¦–       â”‚
â”‚ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«â”‚ â”‚ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«â”‚ â”‚ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«â”‚ â”‚ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚          â”‚          â”‚          â”‚
â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å±¤                  â”‚
â”‚  - ãƒ­ã‚®ãƒ³ã‚°                                               â”‚
â”‚  - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°                                     â”‚
â”‚  - ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰æ§‹æˆ

```
ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ¬ãƒƒãƒ‰ (GUIã‚¹ãƒ¬ãƒƒãƒ‰)
â”œâ”€â”€ GUIæ›´æ–°
â”œâ”€â”€ ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
â””â”€â”€ ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã®å—ä»˜

éŸ³å£°ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚¹ãƒ¬ãƒƒãƒ‰
â”œâ”€â”€ WASAPIçµŒç”±ã§éŸ³å£°ãƒ‡ãƒ¼ã‚¿å–å¾—
â”œâ”€â”€ ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°
â”œâ”€â”€ Queueã¸ã®ãƒ‡ãƒ¼ã‚¿è¿½åŠ 
â””â”€â”€ â˜…å‡¦ç†æ¸ˆã¿ãƒãƒƒãƒ•ã‚¡ã®å³åº§å‰Šé™¤ï¼ˆãƒ¡ãƒ¢ãƒªç®¡ç†ï¼‰

æ–‡å­—èµ·ã“ã—ã‚¹ãƒ¬ãƒƒãƒ‰
â”œâ”€â”€ Queueã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—
â”œâ”€â”€ faster-whisperå‡¦ç†
â”œâ”€â”€ çµæœã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯
â””â”€â”€ â˜…å‡¦ç†æ¸ˆã¿éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã®å³åº§å‰Šé™¤

ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ã‚¿ãƒ«ä¿å­˜ã‚¹ãƒ¬ãƒƒãƒ‰ï¼ˆâ˜…æ–°è¦ï¼‰
â”œâ”€â”€ â˜…ã‚»ã‚°ãƒ¡ãƒ³ãƒˆç”Ÿæˆæ™‚ã«å³åº§ã«ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã¸è¿½è¨˜
â”œâ”€â”€ â˜…5åˆ†ã”ã¨ã«æ­£å¼ãƒ•ã‚¡ã‚¤ãƒ«ã«åæ˜ 
â”œâ”€â”€ â˜…ãƒ¡ãƒ¢ãƒªãƒãƒƒãƒ•ã‚¡ã‚¯ãƒªã‚¢
â””â”€â”€ â˜…ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ

ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ç›£è¦–ã‚¹ãƒ¬ãƒƒãƒ‰ï¼ˆâ˜…æ–°è¦ï¼‰
â”œâ”€â”€ â˜…éŒ²éŸ³é–‹å§‹å‰ã®ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãƒã‚§ãƒƒã‚¯
â”œâ”€â”€ â˜…éŒ²éŸ³ä¸­ã®30ç§’ã”ã¨ã®ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ç›£è¦–
â”œâ”€â”€ â˜…è­¦å‘Šã—ãã„å€¤ï¼ˆ500MBï¼‰ã§è­¦å‘Šè¡¨ç¤º
â”œâ”€â”€ â˜…ç·Šæ€¥ã—ãã„å€¤ï¼ˆ100MBï¼‰ã§éŒ²éŸ³è‡ªå‹•åœæ­¢
â””â”€â”€ â˜…ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã®å®šæœŸã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

ãƒªã‚½ãƒ¼ã‚¹ç›£è¦–ã‚¹ãƒ¬ãƒƒãƒ‰
â”œâ”€â”€ ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãƒã‚§ãƒƒã‚¯
â”œâ”€â”€ CPUä½¿ç”¨ç‡ç›£è¦–
â””â”€â”€ è­¦å‘Šé€šçŸ¥
```

**æ”¹å–„ãƒã‚¤ãƒ³ãƒˆ**:
1. **ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ã‚¿ãƒ«ä¿å­˜ã‚¹ãƒ¬ãƒƒãƒ‰**: æ–‡å­—èµ·ã“ã—çµæœã‚’ãƒ¡ãƒ¢ãƒªã«è“„ç©ã›ãšã€å³åº§ã«ãƒ‡ã‚£ã‚¹ã‚¯ã«æ›¸ãè¾¼ã‚€
2. **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ç›£è¦–ã‚¹ãƒ¬ãƒƒãƒ‰**: ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã‚’å¸¸æ™‚ç›£è¦–ã—ã€ä¸è¶³æ™‚ã«è‡ªå‹•åœæ­¢
3. **ãƒ¡ãƒ¢ãƒªç®¡ç†**: å‡¦ç†æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ã‚’å³åº§ã«å‰Šé™¤ã—ã¦ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’ä¸€å®šã«ä¿ã¤

---

## 3. ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­è¨ˆ

### 3.1 ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ä¸€è¦§

| ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å | ãƒ•ã‚¡ã‚¤ãƒ«å | è²¬å‹™ |
|-------------|-----------|------|
| ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ | `main.py` | ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ |
| éŸ³å£°ã‚­ãƒ£ãƒ—ãƒãƒ£ | `audio_capture.py` | WASAPIçµŒç”±ã®éŸ³å£°å–å¾— |
| æ–‡å­—èµ·ã“ã— | `transcriber.py` | faster-whisperå‡¦ç† |
| GUI | `gui.py` | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ |
| ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç† | `file_manager.py` | ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜ãƒ»ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ |
| è¨­å®šç®¡ç† | `config_manager.py` | è¨­å®šã®èª­ã¿æ›¸ã |
| ãƒªã‚½ãƒ¼ã‚¹ç›£è¦– | `resource_monitor.py` | ãƒ‡ã‚£ã‚¹ã‚¯/ãƒ¡ãƒ¢ãƒªç›£è¦– |
| **ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ã‚¿ãƒ«ä¿å­˜** | `incremental_saver.py` | **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è‡ªå‹•ä¿å­˜** |
| **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ç®¡ç†** | `storage_manager.py` | **ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãƒ»ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†** |
| ãƒ­ã‚®ãƒ³ã‚° | `logger.py` | ãƒ­ã‚°ç®¡ç† |
| ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ© | `error_handler.py` | ã‚¨ãƒ©ãƒ¼å‡¦ç† |

### 3.2 ä¸»è¦ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®è©³ç´°è¨­è¨ˆ

#### 3.2.1 éŸ³å£°ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« (`audio_capture.py`)

**ã‚¯ãƒ©ã‚¹**: `AudioCapture`

**è²¬å‹™**:
- Windowsãƒ«ãƒ¼ãƒ—ãƒãƒƒã‚¯éŸ³å£°ãƒ‡ãƒã‚¤ã‚¹ã®æ¤œå‡º
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ éŸ³å£°ã‚­ãƒ£ãƒ—ãƒãƒ£
- ãƒãƒƒãƒ•ã‚¡ç®¡ç†
- ãƒ‡ãƒã‚¤ã‚¹å†æ¥ç¶š

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:

```python
class AudioCapture:
    def __init__(self, sample_rate=16000, channels=1, buffer_seconds=10):
        """
        Args:
            sample_rate (int): ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ (16kHzæ¨å¥¨)
            channels (int): ãƒãƒ£ãƒ³ãƒãƒ«æ•° (1=ãƒ¢ãƒãƒ©ãƒ«)
            buffer_seconds (int): ãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚º (ç§’)
        """

    def list_devices(self) -> List[Dict[str, Any]]:
        """
        åˆ©ç”¨å¯èƒ½ãªéŸ³å£°ãƒ‡ãƒã‚¤ã‚¹ã®ãƒªã‚¹ãƒˆã‚’å–å¾—

        Returns:
            List[Dict]: ãƒ‡ãƒã‚¤ã‚¹æƒ…å ±ã®ãƒªã‚¹ãƒˆ
                - id: ãƒ‡ãƒã‚¤ã‚¹ID
                - name: ãƒ‡ãƒã‚¤ã‚¹å
                - is_loopback: ãƒ«ãƒ¼ãƒ—ãƒãƒƒã‚¯ãƒ‡ãƒã‚¤ã‚¹ã‹
        """

    def start_capture(self, device_id: int) -> bool:
        """
        éŸ³å£°ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚’é–‹å§‹

        Args:
            device_id (int): ä½¿ç”¨ã™ã‚‹ãƒ‡ãƒã‚¤ã‚¹ID

        Returns:
            bool: æˆåŠŸæ™‚True

        Raises:
            DeviceNotFoundError: ãƒ‡ãƒã‚¤ã‚¹ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ
            AudioCaptureError: ã‚­ãƒ£ãƒ—ãƒãƒ£é–‹å§‹ã«å¤±æ•—ã—ãŸå ´åˆ
        """

    def stop_capture(self):
        """éŸ³å£°ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚’åœæ­¢"""

    def get_audio_buffer(self) -> Optional[np.ndarray]:
        """
        æ–‡å­—èµ·ã“ã—ç”¨ã®éŸ³å£°ãƒãƒƒãƒ•ã‚¡ã‚’å–å¾—

        Returns:
            np.ndarray or None: éŸ³å£°ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºåˆ†ï¼‰
        """

    def get_audio_level(self) -> float:
        """
        ç¾åœ¨ã®éŸ³å£°ãƒ¬ãƒ™ãƒ«ã‚’å–å¾—ï¼ˆ0.0ï½1.0ï¼‰

        Returns:
            float: éŸ³å£°ãƒ¬ãƒ™ãƒ«
        """
```

**å†…éƒ¨å‡¦ç†ãƒ•ãƒ­ãƒ¼**:

```
1. ãƒ‡ãƒã‚¤ã‚¹åˆæœŸåŒ–
   â†“
2. WASAPIãƒ«ãƒ¼ãƒ—ãƒãƒƒã‚¯ãƒ‡ãƒã‚¤ã‚¹å–å¾—
   â†“
3. ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã‚¹ãƒˆãƒªãƒ¼ãƒ é–‹å§‹
   â†“
4. [ãƒ«ãƒ¼ãƒ—] éŸ³å£°ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
   â†“
5. ãƒãƒƒãƒ•ã‚¡ã«è¿½åŠ ï¼ˆdequeä½¿ç”¨ï¼‰
   â†“
6. ãƒãƒƒãƒ•ã‚¡ãŒã„ã£ã±ã„ã«ãªã£ãŸã‚‰é€šçŸ¥
   â†“
7. åœæ­¢å‘½ä»¤ã¾ã§ç¹°ã‚Šè¿”ã—
```

#### 3.2.2 æ–‡å­—èµ·ã“ã—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« (`transcriber.py`)

**ã‚¯ãƒ©ã‚¹**: `Transcriber`

**è²¬å‹™**:
- faster-whisperãƒ¢ãƒ‡ãƒ«ã®ãƒ­ãƒ¼ãƒ‰
- éŸ³å£°â†’ãƒ†ã‚­ã‚¹ãƒˆå¤‰æ›
- è¨€èªåˆ‡ã‚Šæ›¿ãˆ
- VADãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:

```python
class Transcriber:
    def __init__(self, model_path: str, device: str = "cpu",
                 compute_type: str = "int8"):
        """
        Args:
            model_path (str): ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¢ãƒ‡ãƒ«ãƒ‘ã‚¹
            device (str): "cpu" or "cuda"
            compute_type (str): "int8", "float16", "float32"
        """

    def load_model(self) -> bool:
        """
        ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ­ãƒ¼ãƒ‰

        Returns:
            bool: æˆåŠŸæ™‚True

        Raises:
            ModelNotFoundError: ãƒ¢ãƒ‡ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ
            ModelLoadError: ãƒ¢ãƒ‡ãƒ«ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ãŸå ´åˆ
        """

    def transcribe(self, audio_data: np.ndarray, language: str = "ja") -> Dict:
        """
        éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã‚’æ–‡å­—èµ·ã“ã—

        Args:
            audio_data (np.ndarray): éŸ³å£°ãƒ‡ãƒ¼ã‚¿ (16kHz, ãƒ¢ãƒãƒ©ãƒ«)
            language (str): "ja" or "en"

        Returns:
            Dict: {
                "segments": [
                    {
                        "id": int,
                        "start": float,
                        "end": float,
                        "text": str,
                        "confidence": float
                    },
                    ...
                ],
                "language": str,
                "duration": float
            }

        Raises:
            TranscriptionError: æ–‡å­—èµ·ã“ã—ã«å¤±æ•—ã—ãŸå ´åˆ
        """

    def set_language(self, language: str):
        """è¨€èªè¨­å®šã‚’å¤‰æ›´"""

    def get_supported_languages(self) -> List[str]:
        """ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹è¨€èªã®ãƒªã‚¹ãƒˆã‚’å–å¾—"""
```

**faster-whisperè¨­å®š**:

```python
# å®Œå…¨ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å‹•ä½œã®è¨­å®š
model = WhisperModel(
    model_size_or_path="./models/large-v3",  # ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ã‚¹
    device="cpu",
    compute_type="int8",
    download_root=None,  # ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç„¡åŠ¹
    local_files_only=True  # ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿
)

# æ–‡å­—èµ·ã“ã—ã‚ªãƒ—ã‚·ãƒ§ãƒ³
segments, info = model.transcribe(
    audio_data,
    language=language,
    vad_filter=True,  # VADãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æœ‰åŠ¹
    vad_parameters=dict(
        threshold=0.5,
        min_speech_duration_ms=250,
        min_silence_duration_ms=2000
    ),
    beam_size=5,
    hallucination_silence_threshold=0.2  # ãƒãƒ«ã‚·ãƒãƒ¼ã‚·ãƒ§ãƒ³æŠ‘åˆ¶
)
```

#### 3.2.3 GUIãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« (`gui.py`)

**ã‚¯ãƒ©ã‚¹**: `MainWindow`

**è²¬å‹™**:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®æ§‹ç¯‰
- ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤ºæ›´æ–°
- ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã®å—ä»˜

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:

```python
class MainWindow:
    def __init__(self):
        """ãƒ¡ã‚¤ãƒ³ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®åˆæœŸåŒ–"""

    def setup_ui(self):
        """UIè¦ç´ ã®é…ç½®"""

    def on_start_recording(self):
        """éŒ²éŸ³é–‹å§‹ãƒœã‚¿ãƒ³ã®ãƒãƒ³ãƒ‰ãƒ©"""

    def on_stop_recording(self):
        """éŒ²éŸ³åœæ­¢ãƒœã‚¿ãƒ³ã®ãƒãƒ³ãƒ‰ãƒ©"""

    def on_save_file(self):
        """ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜ãƒœã‚¿ãƒ³ã®ãƒãƒ³ãƒ‰ãƒ©"""

    def update_transcription_display(self, text: str, timestamp: str):
        """æ–‡å­—èµ·ã“ã—çµæœã®è¡¨ç¤ºæ›´æ–°"""

    def update_audio_level(self, level: float):
        """éŸ³å£°ãƒ¬ãƒ™ãƒ«ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®æ›´æ–°"""

    def show_error(self, message: str, details: str = None):
        """ã‚¨ãƒ©ãƒ¼ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã®è¡¨ç¤º"""

    def show_settings_dialog(self):
        """è¨­å®šãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã®è¡¨ç¤º"""
```

**UIæ§‹æˆ**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OfflineVoiceLogger v1.0.0                     [_][â–¡][X]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ãƒ•ã‚¡ã‚¤ãƒ«] [ç·¨é›†] [è¡¨ç¤º] [ãƒ„ãƒ¼ãƒ«] [ãƒ˜ãƒ«ãƒ—]              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ãƒ‡ãƒã‚¤ã‚¹: [Stereo Mix â–¼]  è¨€èª: [æ—¥æœ¬èª â–¼]          â”‚
â”‚ ä¿å­˜å…ˆ: [C:\Users\...\Documents   ] [å‚ç…§]           â”‚
â”‚                                                     â”‚
â”‚ [â–  éŒ²éŸ³é–‹å§‹] [â–¡ åœæ­¢] [|| ä¸€æ™‚åœæ­¢]                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ éŸ³å£°ãƒ¬ãƒ™ãƒ«: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 65%              â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ æ–‡å­—èµ·ã“ã—çµæœ                                  â”‚   â”‚
â”‚ â”‚                                                â”‚   â”‚
â”‚ â”‚ [10:30:15] ã“ã‚“ã«ã¡ã¯ã€ãƒ†ã‚¹ãƒˆã§ã™ã€‚              â”‚   â”‚
â”‚ â”‚ [10:30:20] éŸ³å£°èªè­˜ã®ãƒ†ã‚¹ãƒˆã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚      â”‚   â”‚
â”‚ â”‚                                                â”‚   â”‚
â”‚ â”‚                                                â”‚   â”‚
â”‚ â”‚                                                â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš« éŒ²éŸ³ä¸­ | çµŒé: 00:15:32 | æ–‡å­—æ•°: 1,234 | CPU: 45% â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.2.4 ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« (`file_manager.py`)

**ã‚¯ãƒ©ã‚¹**: `FileManager`

**è²¬å‹™**:
- ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜
- è¤‡æ•°å½¢å¼ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
- è‡ªå‹•ä¿å­˜
- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç®¡ç†

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:

```python
class FileManager:
    def __init__(self, base_directory: str):
        """
        Args:
            base_directory (str): ãƒ™ãƒ¼ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
        """

    def save_as_text(self, segments: List[Dict], filepath: str,
                     encoding: str = "utf-8") -> bool:
        """
        TXTå½¢å¼ã§ä¿å­˜

        Args:
            segments (List[Dict]): æ–‡å­—èµ·ã“ã—ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ
            filepath (str): ä¿å­˜å…ˆãƒ‘ã‚¹
            encoding (str): ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°

        Returns:
            bool: æˆåŠŸæ™‚True
        """

    def save_as_srt(self, segments: List[Dict], filepath: str) -> bool:
        """SRTå­—å¹•å½¢å¼ã§ä¿å­˜"""

    def save_as_json(self, data: Dict, filepath: str) -> bool:
        """JSONå½¢å¼ã§ä¿å­˜"""

    def auto_save(self, segments: List[Dict]) -> str:
        """
        è‡ªå‹•ä¿å­˜

        Returns:
            str: ä¿å­˜ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹
        """

    def create_backup(self, filepath: str) -> str:
        """ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ"""

    def cleanup_old_backups(self, max_backups: int = 10):
        """å¤ã„ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å‰Šé™¤"""
```

**ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼**:

**TXTå½¢å¼**:
```
[10:30:15] ã“ã‚“ã«ã¡ã¯ã€ãƒ†ã‚¹ãƒˆã§ã™ã€‚
[10:30:20] éŸ³å£°èªè­˜ã®ãƒ†ã‚¹ãƒˆã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚
```

**SRTå½¢å¼**:
```
1
00:00:00,000 --> 00:00:05,200
ã“ã‚“ã«ã¡ã¯ã€ãƒ†ã‚¹ãƒˆã§ã™ã€‚

2
00:00:05,200 --> 00:00:12,300
éŸ³å£°èªè­˜ã®ãƒ†ã‚¹ãƒˆã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚
```

**JSONå½¢å¼**: ãƒ‡ãƒ¼ã‚¿æ§‹é€ è¨­è¨ˆï¼ˆ4ç« ï¼‰å‚ç…§

#### 3.2.5 ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ã‚¿ãƒ«ä¿å­˜ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« (`incremental_saver.py`)

**ã‚¯ãƒ©ã‚¹**: `IncrementalSaver`

**è²¬å‹™**:
- æ–‡å­—èµ·ã“ã—çµæœã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ä¿å­˜
- ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®æœ€å°åŒ–
- ã‚¯ãƒ©ãƒƒã‚·ãƒ¥æ™‚ã®ãƒ‡ãƒ¼ã‚¿æå¤±é˜²æ­¢
- è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç®¡ç†

**è¨­è¨ˆæ–¹é‡**:
æ–‡å­—èµ·ã“ã—çµæœã‚’ãƒ¡ãƒ¢ãƒªä¸Šã«è“„ç©ã›ãšã€ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã”ã¨ã«ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½è¨˜ã™ã‚‹ã“ã¨ã§ã€é•·æ™‚é–“éŒ²éŸ³ã§ã‚‚ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’ä¸€å®šã«ä¿ã¡ã€ã‚¯ãƒ©ãƒƒã‚·ãƒ¥æ™‚ã®ãƒ‡ãƒ¼ã‚¿æå¤±ã‚’æœ€å°åŒ–ã™ã‚‹ã€‚

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:

```python
class IncrementalSaver:
    def __init__(self, base_filepath: str, auto_save_interval: int = 300):
        """
        Args:
            base_filepath (str): ä¿å­˜å…ˆãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹
            auto_save_interval (int): è‡ªå‹•ä¿å­˜é–“éš”ï¼ˆç§’ï¼‰
        """
        self.base_filepath = base_filepath
        self.temp_filepath = base_filepath + ".tmp"
        self.backup_filepath = base_filepath + ".backup"
        self.auto_save_interval = auto_save_interval
        self.last_save_time = time.time()
        self.unsaved_segments = []
        self.lock = threading.Lock()

    def append_segment(self, segment: Dict) -> bool:
        """
        ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’ãƒ¡ãƒ¢ãƒªã¨ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ 

        Args:
            segment (Dict): æ–‡å­—èµ·ã“ã—ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ
                {
                    "id": int,
                    "start": float,
                    "end": float,
                    "text": str,
                    "confidence": float
                }

        Returns:
            bool: æˆåŠŸæ™‚True

        å‡¦ç†ãƒ•ãƒ­ãƒ¼:
            1. ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’ä¸€æ™‚ãƒªã‚¹ãƒˆã«è¿½åŠ ï¼ˆãƒ¡ãƒ¢ãƒªï¼‰
            2. ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã«å³åº§ã«è¿½è¨˜ï¼ˆãƒ‡ã‚£ã‚¹ã‚¯ï¼‰
            3. è‡ªå‹•ä¿å­˜é–“éš”ã«é”ã—ãŸã‚‰æ­£å¼ãƒ•ã‚¡ã‚¤ãƒ«ã«åæ˜ 
        """
        with self.lock:
            # ãƒ¡ãƒ¢ãƒªã«è¿½åŠ ï¼ˆUIãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤ºç”¨ï¼‰
            self.unsaved_segments.append(segment)

            # ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã«å³åº§ã«è¿½è¨˜ï¼ˆã‚¯ãƒ©ãƒƒã‚·ãƒ¥å¯¾ç­–ï¼‰
            self._append_to_temp_file(segment)

            # è‡ªå‹•ä¿å­˜ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãƒã‚§ãƒƒã‚¯
            if time.time() - self.last_save_time >= self.auto_save_interval:
                self.flush_to_disk()

        return True

    def _append_to_temp_file(self, segment: Dict):
        """ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½è¨˜ï¼ˆæ’ä»–åˆ¶å¾¡ã‚ã‚Šï¼‰"""
        try:
            with open(self.temp_filepath, 'a', encoding='utf-8') as f:
                timestamp = self._format_timestamp(segment['start'])
                f.write(f"[{timestamp}] {segment['text']}\n")
                f.flush()  # ãƒãƒƒãƒ•ã‚¡ã‚’å³åº§ã«ãƒ‡ã‚£ã‚¹ã‚¯ã«æ›¸ãè¾¼ã¿
                os.fsync(f.fileno())  # OSãƒ¬ãƒ™ãƒ«ã§ãƒ‡ã‚£ã‚¹ã‚¯ã«æ›¸ãè¾¼ã¿
        except IOError as e:
            logger.error(f"Failed to append to temp file: {e}")
            raise

    def flush_to_disk(self) -> bool:
        """
        ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ­£å¼ãƒ•ã‚¡ã‚¤ãƒ«ã«åæ˜ 

        å‡¦ç†ãƒ•ãƒ­ãƒ¼:
            1. ç¾åœ¨ã®æ­£å¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
            2. ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ­£å¼ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒªãƒãƒ¼ãƒ 
            3. æ–°ã—ã„ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
            4. ãƒ¡ãƒ¢ãƒªä¸Šã®ãƒãƒƒãƒ•ã‚¡ã‚’ã‚¯ãƒªã‚¢

        Returns:
            bool: æˆåŠŸæ™‚True
        """
        with self.lock:
            try:
                # æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
                if os.path.exists(self.base_filepath):
                    shutil.copy2(self.base_filepath, self.backup_filepath)

                # ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ­£å¼ãƒ•ã‚¡ã‚¤ãƒ«ã«åæ˜ 
                if os.path.exists(self.temp_filepath):
                    shutil.move(self.temp_filepath, self.base_filepath)

                # ãƒ¡ãƒ¢ãƒªãƒãƒƒãƒ•ã‚¡ã‚’ã‚¯ãƒªã‚¢
                self.unsaved_segments.clear()
                self.last_save_time = time.time()

                logger.info(f"Flushed to disk: {self.base_filepath}")
                return True

            except Exception as e:
                logger.error(f"Failed to flush to disk: {e}")
                return False

    def recover_from_crash(self) -> List[Dict]:
        """
        ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã‹ã‚‰å¾©æ—§ï¼ˆä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰èª­ã¿è¾¼ã¿ï¼‰

        Returns:
            List[Dict]: å¾©æ—§ã—ãŸã‚»ã‚°ãƒ¡ãƒ³ãƒˆ
        """
        segments = []

        # ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯å¾©æ—§
        if os.path.exists(self.temp_filepath):
            try:
                with open(self.temp_filepath, 'r', encoding='utf-8') as f:
                    for line in f:
                        segment = self._parse_line(line)
                        if segment:
                            segments.append(segment)
                logger.info(f"Recovered {len(segments)} segments from crash")
            except Exception as e:
                logger.error(f"Failed to recover from crash: {e}")

        return segments

    def get_memory_usage(self) -> int:
        """
        ç¾åœ¨ã®ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’å–å¾—ï¼ˆãƒã‚¤ãƒˆï¼‰

        Returns:
            int: ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ï¼ˆãƒã‚¤ãƒˆï¼‰
        """
        import sys
        return sys.getsizeof(self.unsaved_segments)

    def cleanup(self):
        """ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆçµ‚äº†æ™‚ï¼‰"""
        self.flush_to_disk()
        if os.path.exists(self.temp_filepath):
            os.remove(self.temp_filepath)
```

**ä¿å­˜ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã®è©³ç´°**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¿å­˜ã‚¿ã‚¤ãƒŸãƒ³ã‚°æˆ¦ç•¥                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚ 1. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ä¿å­˜ï¼ˆå³åº§ï¼‰                           â”‚
â”‚    æ–‡å­—èµ·ã“ã—ã‚»ã‚°ãƒ¡ãƒ³ãƒˆç”Ÿæˆ                           â”‚
â”‚    â†“                                                â”‚
â”‚    ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã«å³åº§ã«è¿½è¨˜                           â”‚
â”‚    â†“                                                â”‚
â”‚    ãƒ¡ãƒ¢ãƒªã«ä¿æŒï¼ˆGUIãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤ºç”¨ï¼‰              â”‚
â”‚                                                     â”‚
â”‚ 2. è‡ªå‹•ä¿å­˜ï¼ˆ5åˆ†ã”ã¨ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰                    â”‚
â”‚    ã‚¿ã‚¤ãƒãƒ¼ãƒã‚§ãƒƒã‚¯                                   â”‚
â”‚    â†“                                                â”‚
â”‚    ç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—                       â”‚
â”‚    â†“                                                â”‚
â”‚    ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ« â†’ æ­£å¼ãƒ•ã‚¡ã‚¤ãƒ«ã«åæ˜                   â”‚
â”‚    â†“                                                â”‚
â”‚    ãƒ¡ãƒ¢ãƒªãƒãƒƒãƒ•ã‚¡ã‚¯ãƒªã‚¢                               â”‚
â”‚                                                     â”‚
â”‚ 3. æ‰‹å‹•ä¿å­˜ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œï¼‰                           â”‚
â”‚    ã€Œä¿å­˜ã€ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯                             â”‚
â”‚    â†“                                                â”‚
â”‚    å³åº§ã«flush_to_disk()å®Ÿè¡Œ                         â”‚
â”‚                                                     â”‚
â”‚ 4. çµ‚äº†æ™‚ä¿å­˜                                        â”‚
â”‚    ã‚¢ãƒ—ãƒªçµ‚äº†                                        â”‚
â”‚    â†“                                                â”‚
â”‚    cleanup()ã§å¼·åˆ¶ä¿å­˜                               â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®ç®¡ç†**:

```python
# ãƒ¡ãƒ¢ãƒªåŠ¹ç‡çš„ãªè¨­è¨ˆ
# - æ–‡å­—èµ·ã“ã—çµæœã‚’ãƒ¡ãƒ¢ãƒªã«è“„ç©ã—ãªã„
# - unsaved_segmentsã¯æœ€å¤§5åˆ†é–“ã®ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®ã¿ä¿æŒ
# - è‡ªå‹•ä¿å­˜å¾Œã«å³åº§ã«ã‚¯ãƒªã‚¢

# ä¾‹: 5åˆ†é–“ã®æ–‡å­—èµ·ã“ã—çµæœ
# - å¹³å‡ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæ•°: 60å€‹ï¼ˆ5ç§’ã«1ã‚»ã‚°ãƒ¡ãƒ³ãƒˆï¼‰
# - 1ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã®ã‚µã‚¤ã‚º: ç´„200ãƒã‚¤ãƒˆ
# - åˆè¨ˆãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡: ç´„12KBï¼ˆéå¸¸ã«å°ã•ã„ï¼‰

# å¾“æ¥ã®è¨­è¨ˆï¼ˆå…¨ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ¡ãƒ¢ãƒªã«ä¿æŒï¼‰ã®å ´åˆ:
# - 8æ™‚é–“éŒ²éŸ³: ç´„5,760ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ
# - ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡: ç´„1.2MB
#
# æ–°è¨­è¨ˆï¼ˆ5åˆ†é–“ã®ã¿ä¿æŒï¼‰ã®å ´åˆ:
# - å¸¸ã«60ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ
# - ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡: ç´„12KBï¼ˆ100åˆ†ã®1ï¼‰
```

#### 3.2.6 ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ç®¡ç†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« (`storage_manager.py`)

**ã‚¯ãƒ©ã‚¹**: `StorageManager`

**è²¬å‹™**:
- ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã®ç›£è¦–ã¨ç®¡ç†
- ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
- éŸ³å£°ãƒãƒƒãƒ•ã‚¡ã®ç®¡ç†
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®¹é‡ä¸è¶³æ™‚ã®å¯¾å¿œ

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:

```python
class StorageManager:
    def __init__(self, save_directory: str,
                 warning_threshold_mb: int = 500,
                 critical_threshold_mb: int = 100):
        """
        Args:
            save_directory (str): ä¿å­˜å…ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
            warning_threshold_mb (int): è­¦å‘Šã—ãã„å€¤ï¼ˆMBï¼‰
            critical_threshold_mb (int): ç·Šæ€¥ã—ãã„å€¤ï¼ˆMBï¼‰
        """
        self.save_directory = save_directory
        self.warning_threshold = warning_threshold_mb * 1024 * 1024
        self.critical_threshold = critical_threshold_mb * 1024 * 1024
        self.temp_dir = os.path.join(os.getenv('TEMP'), 'OfflineVoiceLogger')
        os.makedirs(self.temp_dir, exist_ok=True)

    def check_disk_space_before_recording(self) -> Tuple[bool, str]:
        """
        éŒ²éŸ³é–‹å§‹å‰ã®ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãƒã‚§ãƒƒã‚¯

        Returns:
            Tuple[bool, str]: (é–‹å§‹å¯èƒ½ã‹, ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸)
        """
        stat = psutil.disk_usage(self.save_directory)
        free_bytes = stat.free

        # æœ€ä½1GBå¿…è¦
        if free_bytes < 1024 * 1024 * 1024:
            return False, f"ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ä¸è¶³: {free_bytes / (1024**3):.2f}GB\næœ€ä½1GBå¿…è¦ã§ã™ã€‚"

        # 500MBæœªæº€ã§è­¦å‘Š
        if free_bytes < self.warning_threshold:
            return True, f"è­¦å‘Š: ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãŒå°‘ãªããªã£ã¦ã„ã¾ã™ï¼ˆæ®‹ã‚Š{free_bytes / (1024**2):.0f}MBï¼‰"

        return True, "OK"

    def monitor_disk_space_during_recording(self,
                                            callback_warning,
                                            callback_critical) -> threading.Thread:
        """
        éŒ²éŸ³ä¸­ã®ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ç›£è¦–ï¼ˆ30ç§’ã”ã¨ï¼‰

        Args:
            callback_warning: è­¦å‘Šæ™‚ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯
            callback_critical: ç·Šæ€¥æ™‚ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆéŒ²éŸ³åœæ­¢ï¼‰

        Returns:
            threading.Thread: ç›£è¦–ã‚¹ãƒ¬ãƒƒãƒ‰
        """
        def monitor():
            while self.is_monitoring:
                stat = psutil.disk_usage(self.save_directory)
                free_bytes = stat.free

                if free_bytes < self.critical_threshold:
                    callback_critical(f"ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãŒ{free_bytes / (1024**2):.0f}MBæœªæº€ã§ã™ã€‚éŒ²éŸ³ã‚’åœæ­¢ã—ã¾ã™ã€‚")
                    break
                elif free_bytes < self.warning_threshold:
                    callback_warning(f"ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãŒå°‘ãªããªã£ã¦ã„ã¾ã™ï¼ˆæ®‹ã‚Š{free_bytes / (1024**2):.0f}MBï¼‰")

                time.sleep(30)  # 30ç§’ã”ã¨

        self.is_monitoring = True
        thread = threading.Thread(target=monitor, daemon=True)
        thread.start()
        return thread

    def cleanup_temp_audio_buffer(self):
        """
        ä¸€æ™‚éŸ³å£°ãƒãƒƒãƒ•ã‚¡ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

        å‡¦ç†:
            1. TEMPãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®å¤ã„éŸ³å£°ãƒãƒƒãƒ•ã‚¡ã‚’å‰Šé™¤
            2. å‡¦ç†æ¸ˆã¿ãƒãƒƒãƒ•ã‚¡ã‚’å³åº§ã«å‰Šé™¤
        """
        try:
            if os.path.exists(self.temp_dir):
                for filename in os.listdir(self.temp_dir):
                    filepath = os.path.join(self.temp_dir, filename)

                    # 24æ™‚é–“ä»¥ä¸Šå¤ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤
                    if os.path.isfile(filepath):
                        file_age = time.time() - os.path.getmtime(filepath)
                        if file_age > 24 * 3600:
                            os.remove(filepath)
                            logger.info(f"Cleaned up old temp file: {filename}")

        except Exception as e:
            logger.error(f"Failed to cleanup temp files: {e}")

    def get_storage_statistics(self) -> Dict:
        """
        ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸çµ±è¨ˆæƒ…å ±ã‚’å–å¾—

        Returns:
            Dict: {
                "total_gb": float,
                "used_gb": float,
                "free_gb": float,
                "percent_used": float,
                "temp_files_mb": float,
                "transcript_files_count": int,
                "transcript_files_mb": float
            }
        """
        stat = psutil.disk_usage(self.save_directory)

        # ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚µã‚¤ã‚º
        temp_size = self._get_directory_size(self.temp_dir)

        # æ–‡å­—èµ·ã“ã—ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ±è¨ˆ
        transcript_files = []
        if os.path.exists(self.save_directory):
            for filename in os.listdir(self.save_directory):
                if filename.startswith('transcript_'):
                    filepath = os.path.join(self.save_directory, filename)
                    if os.path.isfile(filepath):
                        transcript_files.append(filepath)

        transcript_size = sum(os.path.getsize(f) for f in transcript_files)

        return {
            "total_gb": stat.total / (1024**3),
            "used_gb": stat.used / (1024**3),
            "free_gb": stat.free / (1024**3),
            "percent_used": stat.percent,
            "temp_files_mb": temp_size / (1024**2),
            "transcript_files_count": len(transcript_files),
            "transcript_files_mb": transcript_size / (1024**2)
        }

    def _get_directory_size(self, directory: str) -> int:
        """ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®åˆè¨ˆã‚µã‚¤ã‚ºã‚’å–å¾—ï¼ˆãƒã‚¤ãƒˆï¼‰"""
        total_size = 0
        if os.path.exists(directory):
            for dirpath, dirnames, filenames in os.walk(directory):
                for filename in filenames:
                    filepath = os.path.join(dirpath, filename)
                    if os.path.exists(filepath):
                        total_size += os.path.getsize(filepath)
        return total_size

    def suggest_cleanup_actions(self) -> List[str]:
        """
        ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ææ¡ˆ

        Returns:
            List[str]: ææ¡ˆãƒªã‚¹ãƒˆ
        """
        suggestions = []

        stat = psutil.disk_usage(self.save_directory)
        free_gb = stat.free / (1024**3)

        if free_gb < 1:
            suggestions.append("å¤ã„æ–‡å­—èµ·ã“ã—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ã¦ãã ã•ã„")
            suggestions.append("ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã—ã¦ãã ã•ã„")
            suggestions.append("ä»–ã®ãƒ‰ãƒ©ã‚¤ãƒ–ã«ä¿å­˜å…ˆã‚’å¤‰æ›´ã—ã¦ãã ã•ã„")

        # ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ãŒå¤§ãã„å ´åˆ
        temp_size_mb = self._get_directory_size(self.temp_dir) / (1024**2)
        if temp_size_mb > 100:
            suggestions.append(f"ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ãŒ{temp_size_mb:.0f}MBã‚ã‚Šã¾ã™ã€‚ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚’æ¨å¥¨ã—ã¾ã™ã€‚")

        return suggestions
```

**éŸ³å£°ãƒãƒƒãƒ•ã‚¡ã®ç®¡ç†æˆ¦ç•¥**:

```python
# éŸ³å£°ãƒãƒƒãƒ•ã‚¡ã®ä¸€æ™‚ä¿å­˜ã¨å‰Šé™¤
class AudioBufferStorage:
    """éŸ³å£°ãƒãƒƒãƒ•ã‚¡ã®ä¸€æ™‚ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ç®¡ç†"""

    def __init__(self, temp_dir: str, max_memory_mb: int = 1024):
        self.temp_dir = temp_dir
        self.max_memory_bytes = max_memory_mb * 1024 * 1024
        self.current_buffer = collections.deque()

    def add_audio_chunk(self, audio_data: np.ndarray):
        """éŸ³å£°ãƒãƒ£ãƒ³ã‚¯ã‚’è¿½åŠ """
        # ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãƒã‚§ãƒƒã‚¯
        current_memory = self._get_buffer_memory_size()

        if current_memory > self.max_memory_bytes:
            # ãƒ¡ãƒ¢ãƒªè¶…é: å¤ã„ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ‡ã‚£ã‚¹ã‚¯ã«é€€é¿
            self._flush_to_temp_disk()

        self.current_buffer.append(audio_data)

    def get_buffer_for_transcription(self) -> np.ndarray:
        """æ–‡å­—èµ·ã“ã—ç”¨ãƒãƒƒãƒ•ã‚¡ã‚’å–å¾—"""
        buffer_data = np.concatenate(list(self.current_buffer))

        # ãƒãƒƒãƒ•ã‚¡ã‚¯ãƒªã‚¢ï¼ˆãƒ¡ãƒ¢ãƒªè§£æ”¾ï¼‰
        self.current_buffer.clear()

        return buffer_data

    def _flush_to_temp_disk(self):
        """å¤ã„ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€æ™‚ãƒ‡ã‚£ã‚¹ã‚¯ã«é€€é¿ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰"""
        # é€šå¸¸ã¯ãƒãƒƒãƒ•ã‚¡ã‚¯ãƒªã‚¢ã§å¯¾å¿œ
        # é•·æ™‚é–“éŒ²éŸ³ã®å ´åˆã®ã¿ãƒ‡ã‚£ã‚¹ã‚¯ã«é€€é¿
        pass

    def cleanup_after_transcription(self):
        """æ–‡å­—èµ·ã“ã—å¾Œã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—"""
        # å‡¦ç†æ¸ˆã¿éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã‚’å³åº§ã«å‰Šé™¤
        self.current_buffer.clear()

        # ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚å‰Šé™¤
        if os.path.exists(self.temp_dir):
            for filename in os.listdir(self.temp_dir):
                if filename.startswith('audio_buffer_'):
                    filepath = os.path.join(self.temp_dir, filename)
                    try:
                        os.remove(filepath)
                    except Exception as e:
                        logger.warning(f"Failed to remove temp audio file: {e}")
```

#### 3.2.5 è¨­å®šç®¡ç†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« (`config_manager.py`)

**ã‚¯ãƒ©ã‚¹**: `ConfigManager`

**è²¬å‹™**:
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿æ›¸ã
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã®ç®¡ç†
- è¨­å®šã®æ¤œè¨¼

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:

```python
class ConfigManager:
    def __init__(self, config_path: str = None):
        """
        Args:
            config_path (str): è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹
                ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: %APPDATA%\OfflineVoiceLogger\config.ini
        """

    def load_config(self) -> Dict:
        """è¨­å®šã‚’èª­ã¿è¾¼ã¿"""

    def save_config(self, config: Dict) -> bool:
        """è¨­å®šã‚’ä¿å­˜"""

    def get(self, section: str, key: str, default: Any = None) -> Any:
        """è¨­å®šå€¤ã‚’å–å¾—"""

    def set(self, section: str, key: str, value: Any):
        """è¨­å®šå€¤ã‚’è¨­å®š"""

    def reset_to_default(self):
        """è¨­å®šã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã™"""

    def validate_config(self, config: Dict) -> Tuple[bool, List[str]]:
        """
        è¨­å®šã‚’æ¤œè¨¼

        Returns:
            Tuple[bool, List[str]]: (æ¤œè¨¼çµæœ, ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒªã‚¹ãƒˆ)
        """
```

#### 3.2.6 ãƒªã‚½ãƒ¼ã‚¹ç›£è¦–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« (`resource_monitor.py`)

**ã‚¯ãƒ©ã‚¹**: `ResourceMonitor`

**è²¬å‹™**:
- ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ç›£è¦–
- ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ç›£è¦–
- CPUä½¿ç”¨ç‡ç›£è¦–
- è­¦å‘Šé€šçŸ¥

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:

```python
class ResourceMonitor:
    def __init__(self, warning_threshold_mb: int = 500,
                 critical_threshold_mb: int = 100):
        """
        Args:
            warning_threshold_mb (int): è­¦å‘Šã—ãã„å€¤ï¼ˆMBï¼‰
            critical_threshold_mb (int): ç·Šæ€¥ã—ãã„å€¤ï¼ˆMBï¼‰
        """

    def check_disk_space(self, path: str) -> Tuple[str, int]:
        """
        ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãƒã‚§ãƒƒã‚¯

        Returns:
            Tuple[str, int]: (çŠ¶æ…‹, ç©ºãå®¹é‡)
                çŠ¶æ…‹: "ok", "warning", "critical"
        """

    def check_memory_usage(self) -> Tuple[str, float]:
        """
        ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ãƒã‚§ãƒƒã‚¯

        Returns:
            Tuple[str, float]: (çŠ¶æ…‹, ä½¿ç”¨ç‡)
        """

    def get_cpu_usage(self) -> float:
        """CPUä½¿ç”¨ç‡ã‚’å–å¾— (%)"""

    def start_monitoring(self, interval_seconds: int = 30):
        """å®šæœŸç›£è¦–ã‚’é–‹å§‹"""

    def stop_monitoring(self):
        """ç›£è¦–ã‚’åœæ­¢"""
```

---

## 4. ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆ

### 4.1 ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

#### 4.1.1 æ–‡å­—èµ·ã“ã—çµæœãƒ‡ãƒ¼ã‚¿

```json
{
  "metadata": {
    "version": "1.0.0",
    "created_at": "2025-11-09T10:30:00",
    "device_name": "Stereo Mix",
    "language": "ja",
    "model": "large-v3",
    "duration_seconds": 3600
  },
  "segments": [
    {
      "id": 1,
      "start": 0.0,
      "end": 5.2,
      "text": "ã“ã‚“ã«ã¡ã¯ã€ãƒ†ã‚¹ãƒˆã§ã™ã€‚",
      "confidence": 0.95
    },
    {
      "id": 2,
      "start": 5.2,
      "end": 12.3,
      "text": "éŸ³å£°èªè­˜ã®ãƒ†ã‚¹ãƒˆã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚",
      "confidence": 0.92
    }
  ],
  "statistics": {
    "total_segments": 150,
    "total_characters": 4500,
    "average_confidence": 0.93
  }
}
```

#### 4.1.2 è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« (`config.ini`)

```ini
[General]
version = 1.0.0
first_run = False
language = ja

[Audio]
device_name = Stereo Mix
sample_rate = 16000
buffer_size_seconds = 10
vad_threshold = 0.5

[Transcription]
model = large-v3
language = ja
beam_size = 5
vad_filter = True
hallucination_threshold = 0.2

[UI]
window_width = 800
window_height = 600
window_x = 100
window_y = 100
font_size = 10
theme = light
auto_scroll = True

[Files]
save_directory = C:\Users\{username}\Documents\OfflineVoiceLogger
file_name_template = transcript_{YYYYMMDD}_{HHMMSS}.txt
auto_save_enabled = True
auto_save_interval_minutes = 5
encoding = utf-8

[Storage]
max_memory_usage_mb = 1024
max_buffer_size_seconds = 30
disk_warning_threshold_mb = 500
disk_critical_threshold_mb = 100
auto_cleanup_enabled = True
max_backup_files = 10
max_log_files = 5
debug_audio_save_enabled = False

[Advanced]
log_level = INFO
show_performance_monitor = False
```

### 4.2 ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

```
éŸ³å£°ãƒ‡ãƒã‚¤ã‚¹
    â†“ (éŸ³å£°ãƒ‡ãƒ¼ã‚¿)
éŸ³å£°ã‚­ãƒ£ãƒ—ãƒãƒ£ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
    â†“ (ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°)
Queue (ã‚¹ãƒ¬ãƒƒãƒ‰é–“é€šä¿¡)
    â†“ (éŸ³å£°ãƒ‡ãƒ¼ã‚¿)
æ–‡å­—èµ·ã“ã—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
    â†“ (faster-whisperå‡¦ç†)
æ–‡å­—èµ·ã“ã—çµæœ
    â†“ (ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯)
GUI (ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤º)
    â†“ (ä¿å­˜å‘½ä»¤)
ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
    â†“ (TXT/SRT/JSON)
ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
```

### 4.3 ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
C:\Program Files\OfflineVoiceLogger\
â”œâ”€â”€ OfflineVoiceLogger.exe
â”œâ”€â”€ models\
â”‚   â””â”€â”€ large-v3\
â”‚       â”œâ”€â”€ model.bin
â”‚       â”œâ”€â”€ config.json
â”‚       â””â”€â”€ ...
â”œâ”€â”€ assets\
â”‚   â”œâ”€â”€ icon.ico
â”‚   â””â”€â”€ images\
â””â”€â”€ LICENSE.txt

%APPDATA%\OfflineVoiceLogger\
â”œâ”€â”€ config.ini
â”œâ”€â”€ logs\
â”‚   â”œâ”€â”€ app.log
â”‚   â”œâ”€â”€ app.log.1
â”‚   â””â”€â”€ ...
â”œâ”€â”€ backup\
â”‚   â”œâ”€â”€ transcript_20251109_103000_backup.txt
â”‚   â””â”€â”€ ...
â””â”€â”€ crash_reports\
    â””â”€â”€ crash_20251109_105030.log

%TEMP%\OfflineVoiceLogger\
â””â”€â”€ audio_buffer\
    â””â”€â”€ (ä¸€æ™‚éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ« - å‡¦ç†å¾Œè‡ªå‹•å‰Šé™¤)

%USERPROFILE%\Documents\OfflineVoiceLogger\
â”œâ”€â”€ transcript_20251109_103000.txt
â”œâ”€â”€ transcript_20251109_103000.srt
â””â”€â”€ transcript_20251109_103000.json
```

---

## 5. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ

### 5.1 ãƒ‡ã‚¶ã‚¤ãƒ³æŒ‡é‡

**ã‚³ãƒ³ã‚»ãƒ—ãƒˆ**: ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ã€ä¿¡é ¼æ€§ã€ã‚·ãƒ³ãƒ—ãƒ«ã€è¦–èªæ€§é‡è¦–

### 5.2 ã‚«ãƒ©ãƒ¼ã‚¹ã‚­ãƒ¼ãƒ 

**ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰**:
- ãƒ™ãƒ¼ã‚¹èƒŒæ™¯: #F5F5F5 (ãƒ©ã‚¤ãƒˆã‚°ãƒ¬ãƒ¼)
- ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦èƒŒæ™¯: #FFFFFF (ãƒ›ãƒ¯ã‚¤ãƒˆ)
- ãƒ†ã‚­ã‚¹ãƒˆ: #212121 (ãƒ€ãƒ¼ã‚¯ã‚°ãƒ¬ãƒ¼)
- é–‹å§‹ãƒœã‚¿ãƒ³: #4CAF50 (ã‚°ãƒªãƒ¼ãƒ³)
- åœæ­¢ãƒœã‚¿ãƒ³: #F44336 (ãƒ¬ãƒƒãƒ‰)
- ã‚¢ã‚¯ã‚»ãƒ³ãƒˆ: #2196F3 (ãƒ–ãƒ«ãƒ¼)

**ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰**:
- ãƒ™ãƒ¼ã‚¹èƒŒæ™¯: #1E1E1E
- ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦èƒŒæ™¯: #2D2D2D
- ãƒ†ã‚­ã‚¹ãƒˆ: #E0E0E0
- ã‚¢ã‚¯ã‚»ãƒ³ãƒˆ: #64B5F6

### 5.3 ã‚¿ã‚¤ãƒã‚°ãƒ©ãƒ•ã‚£

- ãƒ•ã‚©ãƒ³ãƒˆ: Yu Gothic UI (æ¸¸ã‚´ã‚·ãƒƒã‚¯ UI)
- ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: Meiryo UI, MS Gothic
- ã‚¿ã‚¤ãƒˆãƒ«: 12pt Bold
- æœ¬æ–‡: 9pt Regular
- æ–‡å­—èµ·ã“ã—çµæœ: 10pt Regular
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼: 8pt Regular

### 5.4 ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

**ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚º**:
- åˆæœŸã‚µã‚¤ã‚º: 800px Ã— 600px
- æœ€å°ã‚µã‚¤ã‚º: 600px Ã— 400px
- ãƒªã‚µã‚¤ã‚ºå¯èƒ½

**ãƒãƒ¼ã‚¸ãƒ³ãƒ»ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°**:
- ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å†…å´: 15px
- ã‚»ã‚¯ã‚·ãƒ§ãƒ³é–“: 10px
- ãƒœã‚¿ãƒ³é–“éš”: 8px

### 5.5 ä¸»è¦ç”»é¢

#### 5.5.1 ãƒ¡ã‚¤ãƒ³ç”»é¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OfflineVoiceLogger v1.0.0                     [_][â–¡][X]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ãƒ•ã‚¡ã‚¤ãƒ«] [ç·¨é›†] [è¡¨ç¤º] [ãƒ„ãƒ¼ãƒ«] [ãƒ˜ãƒ«ãƒ—]              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ãƒ‡ãƒã‚¤ã‚¹: [Stereo Mix â–¼]  è¨€èª: [æ—¥æœ¬èª â–¼]          â”‚
â”‚ ä¿å­˜å…ˆ: [C:\Users\...\Documents   ] [å‚ç…§]           â”‚
â”‚                                                     â”‚
â”‚ [â–  éŒ²éŸ³é–‹å§‹] [â–¡ åœæ­¢] [|| ä¸€æ™‚åœæ­¢] [ğŸ’¾ ä¿å­˜]        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ éŸ³å£°ãƒ¬ãƒ™ãƒ«: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 65%              â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ æ–‡å­—èµ·ã“ã—çµæœ                                  â”‚   â”‚
â”‚ â”‚                                                â”‚   â”‚
â”‚ â”‚ [10:30:15] ã“ã‚“ã«ã¡ã¯ã€ãƒ†ã‚¹ãƒˆã§ã™ã€‚              â”‚   â”‚
â”‚ â”‚ [10:30:20] éŸ³å£°èªè­˜ã®ãƒ†ã‚¹ãƒˆã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚      â”‚   â”‚
â”‚ â”‚                                                â”‚   â”‚
â”‚ â”‚                                                â”‚   â”‚
â”‚ â”‚                                                â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš« éŒ²éŸ³ä¸­ | çµŒé: 00:15:32 | æ–‡å­—æ•°: 1,234 | CPU: 45% â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 5.5.2 è¨­å®šãƒ€ã‚¤ã‚¢ãƒ­ã‚°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¨­å®š                        [_][â–¡][X] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ä¸€èˆ¬] [éŸ³å£°] [æ–‡å­—èµ·ã“ã—] [è¡¨ç¤º] [ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä¸€èˆ¬è¨­å®š                              â”‚
â”‚                                     â”‚
â”‚ è¨€èª:                                â”‚
â”‚ â— æ—¥æœ¬èª  â—‹ English                 â”‚
â”‚                                     â”‚
â”‚ ä¿å­˜å…ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª:                   â”‚
â”‚ [C:\Users\...\Documents    ] [å‚ç…§] â”‚
â”‚                                     â”‚
â”‚ è‡ªå‹•ä¿å­˜:                            â”‚
â”‚ â˜‘ æœ‰åŠ¹                              â”‚
â”‚ é–“éš”: [5] åˆ†                         â”‚
â”‚                                     â”‚
â”‚ ãƒ•ã‚¡ã‚¤ãƒ«åãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ:                â”‚
â”‚ [transcript_{YYYYMMDD}_{HHMMSS}]   â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            [OK] [ã‚­ãƒ£ãƒ³ã‚»ãƒ«] [é©ç”¨]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.6 ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ

| ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ | æ©Ÿèƒ½ |
|--------------|------|
| Ctrl+R | éŒ²éŸ³é–‹å§‹/åœæ­¢ |
| Space | ä¸€æ™‚åœæ­¢/å†é–‹ |
| Ctrl+S | æ‰‹å‹•ä¿å­˜ |
| Ctrl+Shift+S | åå‰ã‚’ä»˜ã‘ã¦ä¿å­˜ |
| Ctrl+F | æ¤œç´¢ |
| Ctrl+C | ã‚³ãƒ”ãƒ¼ |
| Ctrl+A | å…¨é¸æŠ |
| Ctrl+ (+/-) | ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºå¤‰æ›´ |
| Ctrl+, | è¨­å®š |
| F1 | ãƒ˜ãƒ«ãƒ— |
| Ctrl+Q | çµ‚äº† |

---

## 6. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ

### 6.1 ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é€šä¿¡ã®å®Œå…¨é®æ–­

#### 6.1.1 ç’°å¢ƒå¤‰æ•°è¨­å®š

```python
import os

# ãƒ—ãƒ­ã‚­ã‚·è¨­å®šã‚’ç„¡åŠ¹åŒ–
os.environ['no_proxy'] = '*'
os.environ['NO_PROXY'] = '*'
os.environ['http_proxy'] = ''
os.environ['https_proxy'] = ''
os.environ['HTTP_PROXY'] = ''
os.environ['HTTPS_PROXY'] = ''
```

#### 6.1.2 faster-whisperã®ãƒ­ãƒ¼ã‚«ãƒ«å°‚ç”¨è¨­å®š

```python
from faster_whisper import WhisperModel

# å®Œå…¨ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å‹•ä½œ
model = WhisperModel(
    model_size_or_path="./models/large-v3",  # ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ã‚¹æŒ‡å®š
    device="cpu",
    compute_type="int8",
    download_root=None,  # ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç„¡åŠ¹åŒ–
    local_files_only=True  # ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ä½¿ç”¨
)
```

#### 6.1.3 ç¦æ­¢äº‹é …

ä»¥ä¸‹ã®æ©Ÿèƒ½ã¯å®Ÿè£…ã—ãªã„:
- âœ— ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶š
- âœ— è‡ªå‹•æ›´æ–°ãƒã‚§ãƒƒã‚¯
- âœ— ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼é€ä¿¡
- âœ— ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸é€£æº
- âœ— å¤–éƒ¨APIå‘¼ã³å‡ºã—
- âœ— ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ˜ãƒ«ãƒ—
- âœ— ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒ¬ãƒãƒ¼ãƒˆã®å¤–éƒ¨é€ä¿¡

### 6.2 ãƒ‡ãƒ¼ã‚¿ä¿è­·

#### 6.2.1 ãƒ­ãƒ¼ã‚«ãƒ«ä¿å­˜ã®ã¿

- ã™ã¹ã¦ã®éŸ³å£°ãƒ‡ãƒ¼ã‚¿ãƒ»æ–‡å­—èµ·ã“ã—çµæœã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ã®ã¿ã«ä¿å­˜
- ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜
- ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ã¯å®Ÿè£…ã—ãªã„

#### 6.2.2 ãƒ•ã‚¡ã‚¤ãƒ«æš—å·åŒ–ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

```python
from cryptography.fernet import Fernet

def encrypt_file(file_path: str, key: bytes):
    """ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æš—å·åŒ– (AES-256)"""
    f = Fernet(key)
    with open(file_path, 'rb') as file:
        file_data = file.read()
    encrypted_data = f.encrypt(file_data)

    with open(file_path + '.enc', 'wb') as file:
        file.write(encrypted_data)
```

### 6.3 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¤œè¨¼

#### 6.3.1 ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ†é›¢ãƒ†ã‚¹ãƒˆ

```
1. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã‚’ç„¡åŠ¹åŒ–
2. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹•
3. ã™ã¹ã¦ã®æ©Ÿèƒ½ã‚’å®Ÿè¡Œ
4. æ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
```

#### 6.3.2 ãƒ‘ã‚±ãƒƒãƒˆã‚­ãƒ£ãƒ—ãƒãƒ£ç¢ºèª

```
1. Wiresharkã‚’èµ·å‹•
2. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨
3. å¤–éƒ¨é€šä¿¡ãŒ0ä»¶ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
```

#### 6.3.3 ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ãƒ­ã‚°ç¢ºèª

```
1. Windowsãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ãƒ­ã‚°ã‚’æœ‰åŠ¹åŒ–
2. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä½¿ç”¨å¾Œã«ãƒ­ã‚°ã‚’ç¢ºèª
3. å¤–éƒ¨æ¥ç¶šã®è©¦ã¿ãŒ0ä»¶ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
```

---

## 7. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨­è¨ˆ

### 7.1 æ€§èƒ½ç›®æ¨™

#### 7.1.1 å‡¦ç†æ€§èƒ½

| é …ç›® | ç›®æ¨™å€¤ |
|-----|-------|
| æ–‡å­—èµ·ã“ã—é…å»¶ | 15-25ç§’ (large-v3ä½¿ç”¨æ™‚) |
| CPUä½¿ç”¨ç‡ | 50-70% (æ¨å¥¨ç’°å¢ƒ) |
| ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ | 6-8GB (large-v3ä½¿ç”¨æ™‚) |
| GUIå¿œç­”æ€§ | 100msä»¥å†… |

#### 7.1.2 å®‰å®šæ€§

| é …ç›® | ç›®æ¨™å€¤ |
|-----|-------|
| é€£ç¶šç¨¼åƒæ™‚é–“ | 8æ™‚é–“ä»¥ä¸Š |
| ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ | ãªã— |
| ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ç‡ | 0.01%æœªæº€ |

### 7.2 æœ€é©åŒ–æˆ¦ç•¥

#### 7.2.1 ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰å‡¦ç†

```python
import threading
import queue

# ã‚¹ãƒ¬ãƒƒãƒ‰æ§‹æˆ
audio_capture_thread = threading.Thread(target=capture_audio)
transcription_thread = threading.Thread(target=transcribe_audio)
file_write_thread = threading.Thread(target=write_file)

# Queueã§ã‚¹ãƒ¬ãƒƒãƒ‰é–“é€šä¿¡
audio_queue = queue.Queue(maxsize=10)
result_queue = queue.Queue()
```

#### 7.2.2 ãƒãƒƒãƒ•ã‚¡ç®¡ç†

```python
import collections

class AudioBufferManager:
    def __init__(self, max_memory_mb=1024, buffer_seconds=10):
        self.max_memory_bytes = max_memory_mb * 1024 * 1024
        self.buffer_seconds = buffer_seconds
        self.buffer = collections.deque(maxlen=buffer_seconds * 16000)

    def add_audio_data(self, audio_chunk):
        """åŠ¹ç‡çš„ãªFIFOãƒãƒƒãƒ•ã‚¡"""
        self.buffer.extend(audio_chunk)

    def get_buffer(self):
        """ãƒãƒƒãƒ•ã‚¡å–å¾—å¾Œã‚¯ãƒªã‚¢"""
        data = np.array(list(self.buffer))
        self.buffer.clear()
        return data
```

#### 7.2.3 ãƒ¡ãƒ¢ãƒªç®¡ç†

```python
import gc

class MemoryManager:
    def __init__(self):
        self.threshold = 0.9  # 90%

    def check_and_cleanup(self):
        """ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãƒã‚§ãƒƒã‚¯ã¨ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—"""
        memory = psutil.virtual_memory()
        if memory.percent / 100.0 > self.threshold:
            # ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³å¼·åˆ¶å®Ÿè¡Œ
            gc.collect()
            # ãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºç¸®å°
            self.reduce_buffer_size()
```

### 7.3 ãƒªã‚½ãƒ¼ã‚¹ç›£è¦–

#### 7.3.1 ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ç›£è¦–

```python
def monitor_disk_space(save_directory: str, interval: int = 30):
    """30ç§’ã”ã¨ã«ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã‚’ãƒã‚§ãƒƒã‚¯"""
    while is_recording:
        stat = psutil.disk_usage(save_directory)
        free_mb = stat.free / (1024 * 1024)

        if free_mb < 100:  # 100MBæœªæº€
            # éŒ²éŸ³ã‚’è‡ªå‹•åœæ­¢
            stop_recording()
            show_error("ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ä¸è¶³ã®ãŸã‚éŒ²éŸ³ã‚’åœæ­¢ã—ã¾ã—ãŸ")
        elif free_mb < 500:  # 500MBæœªæº€
            show_warning("ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ãŒå°‘ãªããªã£ã¦ã„ã¾ã™")

        time.sleep(interval)
```

#### 7.3.2 ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ç›£è¦–

```python
def monitor_memory_usage():
    """ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®ç›£è¦–"""
    memory = psutil.virtual_memory()
    usage_percent = memory.percent

    if usage_percent > 90:
        # ç·Šæ€¥å¯¾å¿œ
        reduce_buffer_size()
        suggest_lighter_model()
    elif usage_percent > 80:
        show_warning("ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãŒé«˜ããªã£ã¦ã„ã¾ã™")
```

---

## 8. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°è¨­è¨ˆ

### 8.1 ã‚¨ãƒ©ãƒ¼åˆ†é¡

| ã‚«ãƒ†ã‚´ãƒª | é‡è¦åº¦ | å¯¾å¿œ |
|---------|-------|------|
| è‡´å‘½çš„ã‚¨ãƒ©ãƒ¼ | Critical | ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº† |
| é‡å¤§ã‚¨ãƒ©ãƒ¼ | Error | æ©Ÿèƒ½åœæ­¢ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼é€šçŸ¥ |
| è­¦å‘Š | Warning | é€šçŸ¥ã®ã¿ã€å‡¦ç†ç¶™ç¶š |
| æƒ…å ± | Info | ãƒ­ã‚°ã®ã¿ |

### 8.2 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æˆ¦ç•¥

#### 8.2.1 ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–ã‚¯ãƒ©ã‚¹

```python
class OfflineVoiceLoggerError(Exception):
    """ãƒ™ãƒ¼ã‚¹ä¾‹å¤–ã‚¯ãƒ©ã‚¹"""
    pass

class DeviceNotFoundError(OfflineVoiceLoggerError):
    """éŸ³å£°ãƒ‡ãƒã‚¤ã‚¹ãŒè¦‹ã¤ã‹ã‚‰ãªã„"""
    pass

class AudioCaptureError(OfflineVoiceLoggerError):
    """éŸ³å£°ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚¨ãƒ©ãƒ¼"""
    pass

class ModelNotFoundError(OfflineVoiceLoggerError):
    """ãƒ¢ãƒ‡ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„"""
    pass

class ModelLoadError(OfflineVoiceLoggerError):
    """ãƒ¢ãƒ‡ãƒ«ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼"""
    pass

class TranscriptionError(OfflineVoiceLoggerError):
    """æ–‡å­—èµ·ã“ã—ã‚¨ãƒ©ãƒ¼"""
    pass

class DiskSpaceError(OfflineVoiceLoggerError):
    """ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ä¸è¶³"""
    pass

class MemoryError(OfflineVoiceLoggerError):
    """ãƒ¡ãƒ¢ãƒªä¸è¶³"""
    pass
```

#### 8.2.2 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©å®Ÿè£…

```python
class ErrorHandler:
    def __init__(self, logger):
        self.logger = logger

    def handle_error(self, error: Exception, context: str = ""):
        """ã‚¨ãƒ©ãƒ¼ã‚’å‡¦ç†"""
        error_type = type(error).__name__
        error_message = str(error)

        # ãƒ­ã‚°è¨˜éŒ²
        self.logger.error(f"[{context}] {error_type}: {error_message}",
                         exc_info=True)

        # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®é€šçŸ¥
        if isinstance(error, DeviceNotFoundError):
            self._handle_device_not_found(error)
        elif isinstance(error, ModelNotFoundError):
            self._handle_model_not_found(error)
        elif isinstance(error, DiskSpaceError):
            self._handle_disk_space_error(error)
        elif isinstance(error, MemoryError):
            self._handle_memory_error(error)
        else:
            self._handle_generic_error(error)

    def _handle_device_not_found(self, error):
        """éŸ³å£°ãƒ‡ãƒã‚¤ã‚¹ã‚¨ãƒ©ãƒ¼ã®å‡¦ç†"""
        show_error_dialog(
            title="éŸ³å£°ãƒ‡ãƒã‚¤ã‚¹ã‚¨ãƒ©ãƒ¼",
            message="éŸ³å£°ãƒ‡ãƒã‚¤ã‚¹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚",
            details=str(error),
            suggestions=[
                "1. ãƒ‡ãƒã‚¤ã‚¹ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã§éŸ³å£°ãƒ‡ãƒã‚¤ã‚¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„",
                "2. ã‚¹ãƒ†ãƒ¬ã‚ªãƒŸã‚­ã‚µãƒ¼ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„",
                "3. ãƒ‡ãƒã‚¤ã‚¹ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„"
            ]
        )
```

#### 8.2.3 ã‚¨ãƒ©ãƒ¼ãƒ€ã‚¤ã‚¢ãƒ­ã‚°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš  ã‚¨ãƒ©ãƒ¼                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ éŸ³å£°ãƒ‡ãƒã‚¤ã‚¹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚         â”‚
â”‚                                     â”‚
â”‚ è§£æ±ºæ–¹æ³•:                            â”‚
â”‚ 1. ãƒ‡ãƒã‚¤ã‚¹ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã§éŸ³å£°ãƒ‡ãƒã‚¤ã‚¹ â”‚
â”‚    ã‚’ç¢ºèªã—ã¦ãã ã•ã„                 â”‚
â”‚ 2. ã‚¹ãƒ†ãƒ¬ã‚ªãƒŸã‚­ã‚µãƒ¼ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ â”‚
â”‚    ã‹ç¢ºèªã—ã¦ãã ã•ã„                 â”‚
â”‚ 3. ãƒ‡ãƒã‚¤ã‚¹ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« â”‚
â”‚    ã—ã¦ãã ã•ã„                       â”‚
â”‚                                     â”‚
â”‚ [è©³ç´°ã‚’è¡¨ç¤º â–¼]                       â”‚
â”‚                                     â”‚
â”‚          [OK] [ãƒ˜ãƒ«ãƒ—ã‚’é–‹ã]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.3 ãƒ­ã‚®ãƒ³ã‚°è¨­è¨ˆ

#### 8.3.1 ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«

| ãƒ¬ãƒ™ãƒ« | ç”¨é€” |
|-------|------|
| DEBUG | é–‹ç™ºæ™‚ã®ãƒ‡ãƒãƒƒã‚°æƒ…å ± |
| INFO | é€šå¸¸ã®å‹•ä½œæƒ…å ± |
| WARNING | è­¦å‘Šï¼ˆå‡¦ç†ã¯ç¶™ç¶šï¼‰ |
| ERROR | ã‚¨ãƒ©ãƒ¼ï¼ˆæ©Ÿèƒ½åœæ­¢ï¼‰ |
| CRITICAL | è‡´å‘½çš„ã‚¨ãƒ©ãƒ¼ï¼ˆã‚¢ãƒ—ãƒªçµ‚äº†ï¼‰ |

#### 8.3.2 ãƒ­ã‚°å®Ÿè£…

```python
import logging
from logging.handlers import RotatingFileHandler

def setup_logger():
    """ãƒ­ã‚¬ãƒ¼ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—"""
    log_dir = os.path.join(os.getenv('APPDATA'), 'OfflineVoiceLogger', 'logs')
    os.makedirs(log_dir, exist_ok=True)

    log_file = os.path.join(log_dir, 'app.log')

    # ãƒ­ã‚°ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
    formatter = logging.Formatter(
        '[%(asctime)s] [%(levelname)s] [%(name)s] %(message)s',
        datefmt='%Y-%m-%d %H:%M:%S'
    )

    # ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒ³ãƒ‰ãƒ©ï¼ˆãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
    file_handler = RotatingFileHandler(
        log_file,
        maxBytes=10*1024*1024,  # 10MB
        backupCount=5
    )
    file_handler.setFormatter(formatter)

    # ãƒ«ãƒ¼ãƒˆãƒ­ã‚¬ãƒ¼è¨­å®š
    logger = logging.getLogger()
    logger.setLevel(logging.INFO)
    logger.addHandler(file_handler)

    return logger
```

#### 8.3.3 ãƒ­ã‚°å‡ºåŠ›ä¾‹

```
[2025-11-09 10:30:15] [INFO] [MainWindow] Application started
[2025-11-09 10:30:16] [INFO] [AudioCapture] Initializing audio device: Stereo Mix
[2025-11-09 10:30:17] [INFO] [Transcriber] Loading model: large-v3
[2025-11-09 10:30:25] [INFO] [Transcriber] Model loaded successfully
[2025-11-09 10:30:30] [INFO] [AudioCapture] Recording started
[2025-11-09 10:30:40] [WARNING] [AudioCapture] Buffer overflow detected
[2025-11-09 10:31:05] [ERROR] [AudioCapture] Device disconnected: Stereo Mix
[2025-11-09 10:31:05] [INFO] [AudioCapture] Attempting to reconnect...
```

### 8.4 ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒ¬ãƒãƒ¼ãƒˆ

#### 8.4.1 ã‚¯ãƒ©ãƒƒã‚·ãƒ¥æ™‚ã®å‡¦ç†

```python
import sys
import traceback

def handle_crash(exc_type, exc_value, exc_traceback):
    """ã‚¯ãƒ©ãƒƒã‚·ãƒ¥æ™‚ã®ãƒãƒ³ãƒ‰ãƒ©"""
    # ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ
    crash_dir = os.path.join(os.getenv('APPDATA'),
                            'OfflineVoiceLogger',
                            'crash_reports')
    os.makedirs(crash_dir, exist_ok=True)

    timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
    crash_file = os.path.join(crash_dir, f'crash_{timestamp}.log')

    with open(crash_file, 'w', encoding='utf-8') as f:
        f.write(f"Crash Report - {timestamp}\n")
        f.write("=" * 60 + "\n")
        f.write(f"Exception Type: {exc_type.__name__}\n")
        f.write(f"Exception Message: {exc_value}\n\n")
        f.write("Traceback:\n")
        traceback.print_exception(exc_type, exc_value, exc_traceback, file=f)

    # ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç·Šæ€¥ä¿å­˜
    emergency_save()

    # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€šçŸ¥
    show_crash_dialog(crash_file)

# ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒãƒ³ãƒ‰ãƒ©è¨­å®š
sys.excepthook = handle_crash
```

---

## 9. ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆè¨­è¨ˆ

### 9.1 EXEåŒ–

#### 9.1.1 PyInstallerã‚¹ãƒšãƒƒã‚¯ãƒ•ã‚¡ã‚¤ãƒ«

```python
# OfflineVoiceLogger.spec
# -*- mode: python ; coding: utf-8 -*-

block_cipher = None

a = Analysis(
    ['src/main.py'],
    pathex=[],
    binaries=[],
    datas=[
        ('models', 'models'),  # ãƒ¢ãƒ‡ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å«ã‚ã‚‹
        ('assets', 'assets'),  # ã‚¢ã‚¤ã‚³ãƒ³ãªã©
    ],
    hiddenimports=[
        'faster_whisper',
        'sounddevice',
        'numpy',
    ],
    hookspath=[],
    hooksconfig={},
    runtime_hooks=[],
    excludes=[],
    win_no_prefer_redirects=False,
    win_private_assemblies=False,
    cipher=block_cipher,
    noarchive=False,
)

pyz = PYZ(a.pure, a.zipped_data, cipher=block_cipher)

exe = EXE(
    pyz,
    a.scripts,
    a.binaries,
    a.zipfiles,
    a.datas,
    [],
    name='OfflineVoiceLogger',
    debug=False,
    bootloader_ignore_signals=False,
    strip=False,
    upx=True,
    upx_exclude=[],
    runtime_tmpdir=None,
    console=False,  # GUIã‚¢ãƒ—ãƒª
    disable_windowed_traceback=False,
    argv_emulation=False,
    target_arch=None,
    codesign_identity=None,
    entitlements_file=None,
    icon='assets/icon.ico',  # ã‚¢ã‚¤ã‚³ãƒ³
    version='version_info.txt'  # ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±
)
```

#### 9.1.2 ãƒ“ãƒ«ãƒ‰ã‚³ãƒãƒ³ãƒ‰

```bash
pyinstaller OfflineVoiceLogger.spec
```

### 9.2 MSIã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼

#### 9.2.1 WiX Toolsetè¨­å®š (Product.wxs)

```xml
<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*"
           Name="OfflineVoiceLogger"
           Language="1041"
           Version="1.0.0"
           Manufacturer="Your Name"
           UpgradeCode="YOUR-GUID-HERE">

    <Package InstallerVersion="200"
             Compressed="yes"
             InstallScope="perMachine" />

    <MajorUpgrade DowngradeErrorMessage="æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒæ—¢ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã™ã€‚" />
    <MediaTemplate EmbedCab="yes" />

    <!-- æ©Ÿèƒ½å®šç¾© -->
    <Feature Id="ProductFeature" Title="OfflineVoiceLogger" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
      <ComponentRef Id="ApplicationShortcut" />
      <ComponentRef Id="DesktopShortcut" />
    </Feature>

    <!-- UIã‚·ãƒ¼ã‚±ãƒ³ã‚¹ -->
    <UIRef Id="WixUI_InstallDir" />
    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLFOLDER" />
  </Product>

  <!-- ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€  -->
  <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFiles64Folder">
        <Directory Id="INSTALLFOLDER" Name="OfflineVoiceLogger">
          <Directory Id="ModelsFolder" Name="models" />
          <Directory Id="AssetsFolder" Name="assets" />
        </Directory>
      </Directory>

      <Directory Id="ProgramMenuFolder">
        <Directory Id="ApplicationProgramsFolder" Name="OfflineVoiceLogger"/>
      </Directory>

      <Directory Id="DesktopFolder" Name="Desktop" />
    </Directory>
  </Fragment>

  <!-- ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®šç¾© -->
  <Fragment>
    <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
      <Component Id="MainExecutable">
        <File Id="OfflineVoiceLoggerEXE"
              Source="dist\OfflineVoiceLogger.exe"
              KeyPath="yes" />
      </Component>

      <!-- ãƒ¢ãƒ‡ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ -->
      <Component Id="ModelFiles" Directory="ModelsFolder">
        <File Source="models\large-v3\model.bin" />
        <File Source="models\large-v3\config.json" />
        <!-- ãã®ä»–ã®ãƒ¢ãƒ‡ãƒ«ãƒ•ã‚¡ã‚¤ãƒ« -->
      </Component>
    </ComponentGroup>

    <!-- ã‚¹ã‚¿ãƒ¼ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ -->
    <DirectoryRef Id="ApplicationProgramsFolder">
      <Component Id="ApplicationShortcut">
        <Shortcut Id="ApplicationStartMenuShortcut"
                  Name="OfflineVoiceLogger"
                  Target="[INSTALLFOLDER]OfflineVoiceLogger.exe"
                  WorkingDirectory="INSTALLFOLDER"
                  Icon="AppIcon" />
        <RemoveFolder Id="CleanUpShortCut" Directory="ApplicationProgramsFolder" On="uninstall"/>
        <RegistryValue Root="HKCU"
                      Key="Software\OfflineVoiceLogger"
                      Name="installed"
                      Type="integer"
                      Value="1"
                      KeyPath="yes"/>
      </Component>
    </DirectoryRef>

    <!-- ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ -->
    <DirectoryRef Id="DesktopFolder">
      <Component Id="DesktopShortcut">
        <Shortcut Id="DesktopShortcut"
                  Name="OfflineVoiceLogger"
                  Target="[INSTALLFOLDER]OfflineVoiceLogger.exe"
                  WorkingDirectory="INSTALLFOLDER"
                  Icon="AppIcon" />
        <RegistryValue Root="HKCU"
                      Key="Software\OfflineVoiceLogger"
                      Name="desktop_shortcut"
                      Type="integer"
                      Value="1"
                      KeyPath="yes"/>
      </Component>
    </DirectoryRef>
  </Fragment>

  <!-- ã‚¢ã‚¤ã‚³ãƒ³å®šç¾© -->
  <Fragment>
    <Icon Id="AppIcon" SourceFile="assets\icon.ico" />
  </Fragment>
</Wix>
```

#### 9.2.2 MSIãƒ“ãƒ«ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```batch
@echo off
echo Building MSI Installer...

REM WiX Toolset ã®ãƒ‘ã‚¹
set WIX_PATH=C:\Program Files (x86)\WiX Toolset v3.11\bin

REM ãƒ“ãƒ«ãƒ‰
"%WIX_PATH%\candle.exe" Product.wxs -out obj\Product.wixobj
"%WIX_PATH%\light.exe" obj\Product.wixobj -out bin\OfflineVoiceLogger.msi -ext WixUIExtension

echo Build complete!
pause
```

### 9.3 ãƒªãƒªãƒ¼ã‚¹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸

#### 9.3.1 ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
OfflineVoiceLogger_v1.0.0_Release\
â”œâ”€â”€ OfflineVoiceLogger_v1.0.0.msi
â”œâ”€â”€ README.txt
â”œâ”€â”€ LICENSE.txt
â”œâ”€â”€ CHANGELOG.txt
â”œâ”€â”€ docs\
â”‚   â”œâ”€â”€ UserGuide.pdf
â”‚   â””â”€â”€ Troubleshooting.pdf
â””â”€â”€ checksums.txt
```

#### 9.3.2 README.txt

```
OfflineVoiceLogger v1.0.0
=========================

å®Œå…¨ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å‹•ä½œã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ éŸ³å£°æ–‡å­—èµ·ã“ã—ãƒ„ãƒ¼ãƒ«

â–  ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶
- OS: Windows 10/11 (64bit)
- CPU: Intel Core i5 ç¬¬8ä¸–ä»£ä»¥ä¸Š
- ãƒ¡ãƒ¢ãƒª: 8GBä»¥ä¸Šï¼ˆ16GBæ¨å¥¨ï¼‰
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: 5GBä»¥ä¸Šã®ç©ºãå®¹é‡

â–  ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•
1. OfflineVoiceLogger_v1.0.0.msi ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯
2. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ã®æŒ‡ç¤ºã«å¾“ã£ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
3. ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™

â–  ä½¿ç”¨æ–¹æ³•
è©³ç´°ã¯ docs\UserGuide.pdf ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

â–  ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«ã¤ã„ã¦
æœ¬ãƒ„ãƒ¼ãƒ«ã¯å®Œå…¨ã«ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§å‹•ä½œã—ã¾ã™ã€‚
ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã¯ä¸€åˆ‡è¡Œã„ã¾ã›ã‚“ã€‚

â–  ã‚µãƒãƒ¼ãƒˆ
å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã¯ docs\Troubleshooting.pdf ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

â–  ãƒ©ã‚¤ã‚»ãƒ³ã‚¹
LICENSE.txt ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
```

### 9.4 é…å¸ƒãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

```
â–¡ EXEãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ“ãƒ«ãƒ‰å®Œäº†
â–¡ MSIã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã®ãƒ“ãƒ«ãƒ‰å®Œäº†
â–¡ ã‚¦ã‚¤ãƒ«ã‚¹ã‚¹ã‚­ãƒ£ãƒ³å®Œäº†
â–¡ ã‚¯ãƒªãƒ¼ãƒ³PCç’°å¢ƒã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ†ã‚¹ãƒˆå®Œäº†
â–¡ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ†é›¢çŠ¶æ…‹ã§ã®å‹•ä½œç¢ºèªå®Œäº†
â–¡ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¸€å¼ä½œæˆå®Œäº†
â–¡ README.txtä½œæˆå®Œäº†
â–¡ CHANGELOG.txtä½œæˆå®Œäº†
â–¡ ãƒã‚§ãƒƒã‚¯ã‚µãƒ ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆå®Œäº†
â–¡ ZIPãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆå®Œäº†
â–¡ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ç¢ºèªå®Œäº†
```

---

## ä»˜éŒ²

### A. é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

#### A.1 å¿…è¦ãªãƒ„ãƒ¼ãƒ«

```
- Python 3.9ä»¥ä¸Š
- PyInstaller
- WiX Toolset 3.11
- Visual Studio Code (æ¨å¥¨)
- Git
```

#### A.2 ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒª (requirements.txt)

```
faster-whisper==0.10.0
sounddevice==0.4.6
numpy==1.24.3
psutil==5.9.5
cryptography==41.0.3
```

### B. ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä¸€è¦§

è©³ç´°ã¯åˆ¥ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€ŒTEST_PLAN.mdã€ã‚’å‚ç…§ã€‚

### C. æ—¢çŸ¥ã®å•é¡Œ

- Windows 11ã®ä¸€éƒ¨ç’°å¢ƒã§ã‚¹ãƒ†ãƒ¬ã‚ªãƒŸã‚­ã‚µãƒ¼ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ç„¡åŠ¹
  â†’ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ã«å¯¾å‡¦æ³•ã‚’è¨˜è¼‰

### D. ä»Šå¾Œã®æ©Ÿèƒ½æ‹¡å¼µäºˆå®š

- Phase 4 (ã‚ªãƒ—ã‚·ãƒ§ãƒ³æ©Ÿèƒ½) å‚ç…§
- ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ
- ãƒ‡ãƒ¼ã‚¿æš—å·åŒ–
- å¤šè¨€èªUI (è‹±èª)

---

**æ–‡æ›¸å±¥æ­´**

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | æ—¥ä»˜ | å¤‰æ›´å†…å®¹ | ä½œæˆè€… |
|-----------|------|---------|-------|
| 1.0.0 | 2025-11-09 | åˆç‰ˆä½œæˆ | - |

---

**æ‰¿èª**

| å½¹å‰² | æ°å | æ‰¿èªæ—¥ | ç½²å |
|-----|------|-------|------|
| è¨­è¨ˆè€… | - | - | - |
| ãƒ¬ãƒ“ãƒ¥ãƒ¼æ‹…å½“ | - | - | - |
| æ‰¿èªè€… | - | - | - |

---

**END OF DOCUMENT**
